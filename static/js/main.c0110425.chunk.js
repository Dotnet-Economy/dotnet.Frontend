(this["webpackJsonpdotnet.frontend"]=this["webpackJsonpdotnet.frontend"]||[]).push([[0],{74:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){"use strict";n.r(t);n(69);var r=n(0),a=n.n(r),s=n(32),i=n.n(s),c=(n(74),n(16)),o=n(11),u=n(12),l=n(13),h=n(14),d=n(15),p=n(94),b=n(50),j=n(9),f=n(5),m=n.n(f),g=n(104),v=n(103),O=n(57),x="returnUrl",y="message",k="logout-callback",w="logout",S="logged-out",I="login",A="login-callback",C="login-failed",T="profile",L="register",U="/authentication",R={DefaultLoginRedirectPath:"/",ApiAuthorizationPrefix:U,Login:"".concat(U,"/").concat(I),LoginFailed:"".concat(U,"/").concat(C),LoginCallback:"".concat(U,"/").concat(A),Register:"".concat(U,"/").concat(L),Profile:"".concat(U,"/").concat(T),LogOut:"".concat(U,"/").concat(w),LoggedOut:"".concat(U,"/").concat(S),LogOutCallback:"".concat(U,"/").concat(k),IdentityRegisterPath:"/Identity/Account/Register",IdentityManagePath:"/Identity/Account/Manage"},_=function(){function e(){Object(o.a)(this,e),this._callbacks=[],this._nextSubscriptionId=0,this._user=null,this._isAuthenticated=!1,this._popUpDisabled=!0}return Object(u.a)(e,[{key:"isAuthenticated",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getUser();case 2:return t=e.sent,e.abrupt("return",!!t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUser",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._user||!this._user.profile){e.next=2;break}return e.abrupt("return",this._user.profile);case 2:return e.next=4,this.ensureUserManagerInitialized();case 4:return e.next=6,this.userManager.getUser();case 6:return t=e.sent,e.abrupt("return",t&&t.profile);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAccessToken",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureUserManagerInitialized();case 2:return e.next=4,this.userManager.getUser();case 4:return t=e.sent,e.abrupt("return",t&&t.access_token);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signIn",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureUserManagerInitialized();case 2:return e.prev=2,e.next=5,this.userManager.signinSilent(this.createArguments());case 5:return n=e.sent,this.updateState(n),e.abrupt("return",this.success(t));case 10:if(e.prev=10,e.t0=e.catch(2),console.log("Silent authentication error: ",e.t0),e.prev=13,!this._popUpDisabled){e.next=16;break}throw new Error("Popup disabled. Change 'AuthorizeService.js:AuthorizeService._popupDisabled' to false to enable it.");case 16:return e.next=18,this.userManager.signinPopup(this.createArguments());case 18:return r=e.sent,this.updateState(r),e.abrupt("return",this.success(t));case 23:if(e.prev=23,e.t1=e.catch(13),"Popup window closed"!==e.t1.message){e.next=29;break}return e.abrupt("return",this.error("The user closed the window."));case 29:this._popUpDisabled||console.log("Popup authentication error: ",e.t1);case 30:return e.prev=30,e.next=33,this.userManager.signinRedirect(this.createArguments(t));case 33:return e.abrupt("return",this.redirect());case 36:return e.prev=36,e.t2=e.catch(30),console.log("Redirect authentication error: ",e.t2),e.abrupt("return",this.error(e.t2));case 40:case"end":return e.stop()}}),e,this,[[2,10],[13,23],[30,36]])})));return function(t){return e.apply(this,arguments)}}()},{key:"completeSignIn",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.ensureUserManagerInitialized();case 3:return e.next=5,this.userManager.signinCallback(t);case 5:return n=e.sent,this.updateState(n),e.abrupt("return",this.success(n&&n.state));case 10:return e.prev=10,e.t0=e.catch(0),console.log("There was an error signing in: ",e.t0),e.abrupt("return",this.error("There was an error signing in."));case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=Object(j.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureUserManagerInitialized();case 2:if(e.prev=2,!this._popUpDisabled){e.next=5;break}throw new Error("Popup disabled. Change 'AuthorizeService.js:AuthorizeService._popupDisabled' to false to enable it.");case 5:return e.next=7,this.userManager.signoutPopup(this.createArguments());case 7:return this.updateState(void 0),e.abrupt("return",this.success(t));case 11:return e.prev=11,e.t0=e.catch(2),console.log("Popup signout error: ",e.t0),e.prev=14,e.next=17,this.userManager.signoutRedirect(this.createArguments(t));case 17:return e.abrupt("return",this.redirect());case 20:return e.prev=20,e.t1=e.catch(14),console.log("Redirect signout error: ",e.t1),e.abrupt("return",this.error(e.t1));case 24:case"end":return e.stop()}}),e,this,[[2,11],[14,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"completeSignOut",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureUserManagerInitialized();case 2:return e.prev=2,e.next=5,this.userManager.signoutCallback(t);case 5:return n=e.sent,this.updateState(null),e.abrupt("return",this.success(n&&n.data));case 10:return e.prev=10,e.t0=e.catch(2),console.log("There was an error trying to log out '".concat(e.t0,"'.")),e.abrupt("return",this.error(e.t0));case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"updateState",value:function(e){this._user=e,this._isAuthenticated=!!this._user,this.notifySubscribers()}},{key:"subscribe",value:function(e){return this._callbacks.push({callback:e,subscription:this._nextSubscriptionId++}),this._nextSubscriptionId-1}},{key:"unsubscribe",value:function(e){var t=this._callbacks.map((function(t,n){return t.subscription===e?{found:!0,index:n}:{found:!1}})).filter((function(e){return!0===e.found}));if(1!==t.length)throw new Error("Found an invalid number of subscriptions ".concat(t.length));this._callbacks.splice(t[0].index,1)}},{key:"notifySubscribers",value:function(){for(var e=0;e<this._callbacks.length;e++){(0,this._callbacks[e].callback)()}}},{key:"createArguments",value:function(e){return{useReplaceToNavigate:!0,data:e}}},{key:"error",value:function(e){return{status:M.Fail,message:e}}},{key:"success",value:function(e){return{status:M.Success,state:e}}},{key:"redirect",value:function(){return{status:M.Redirect}}},{key:"ensureUserManagerInitialized",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n,r=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.userManager){e.next=2;break}return e.abrupt("return");case 2:t=window.location.origin,(n={authority:"".concat(window.IDENTITY_SERVICE_URL),client_id:"frontend",redirect_uri:"".concat(t).concat(R.LoginCallback),response_type:"code",scope:"openid profile catalog.fullaccess inventory.fullaccess trading.fullaccess IdentityServerApi roles",post_logout_redirect_uri:"".concat(t).concat(R.LogOutCallback)}).automaticSilentRenew=!0,n.includeIdTokenInSilentRenew=!0,n.userStore=new O.WebStorageStateStore({prefix:"DotnetEconomy"}),this.userManager=new O.UserManager(n),this.userManager.events.addUserSignedOut(Object(j.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.userManager.removeUser();case 2:r.updateState(void 0);case 3:case"end":return e.stop()}}),e)}))));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"instance",get:function(){return P}}]),e}(),P=new _,E=P,M={Redirect:"redirect",Success:"success",Fail:"fail"},N="/catalog",F="/inventory",D="/users",B="/store",V=n(1),z=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={isAuthenticated:!1,userName:null,role:null},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this._subscription=E.subscribe((function(){return e.populateState()})),this.populateState()}},{key:"componentWillUnmount",value:function(){E.unsubscribe(this._subscription)}},{key:"populateState",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n,r,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([E.isAuthenticated(),E.getUser()]);case 2:t=e.sent,n=Object(b.a)(t,2),r=n[0],a=n[1],this.setState({isAuthenticated:r,userName:a&&a.name,role:a&&a.role});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(V.jsx)("header",{children:Object(V.jsx)(g.a,{bg:"light",expand:"lg",children:Object(V.jsxs)(p.a,{children:[Object(V.jsx)(g.a.Brand,{as:c.b,to:"/",style:q.navBarText,children:"Dotnet Economy"}),Object(V.jsx)(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(V.jsx)(g.a.Collapse,{id:"basic-navbar-nav",children:this.checkAuthAndRenderMenuItems()})]})})})}},{key:"checkAuthAndRenderMenuItems",value:function(){return this.state.isAuthenticated?this.authenticatedView():this.anonymousView()}},{key:"anonymousView",value:function(){var e="".concat(R.Login);return Object(V.jsxs)(r.Fragment,{children:[Object(V.jsx)(v.a,{className:"mr-auto",children:Object(V.jsx)(v.a.Link,{as:c.b,to:"/",children:"Home"})}),Object(V.jsx)(v.a,{children:Object(V.jsx)(v.a.Link,{as:c.b,to:e,children:"Login"})})]})}},{key:"authenticatedView",value:function(){return"Admin"===this.state.role?Object(V.jsxs)(r.Fragment,{children:[Object(V.jsxs)(v.a,{className:"mr-auto",children:[Object(V.jsx)(v.a.Link,{as:c.b,to:"/",style:q.navBarText,children:"Home"}),this.storeAndInventoryItems(),Object(V.jsx)(v.a.Link,{as:c.b,to:N,style:q.navBarText,children:"Catalog"}),Object(V.jsx)(v.a.Link,{as:c.b,to:D,style:q.navBarText,children:"Users"})]}),Object(V.jsx)(v.a,{children:this.profileAndLogoutItems()})]}):"Player"===this.state.role?Object(V.jsxs)(r.Fragment,{children:[Object(V.jsxs)(v.a,{className:"mr-auto",children:[Object(V.jsx)(v.a.Link,{as:c.b,to:"/",children:"Home"}),this.storeAndInventoryItems()]}),Object(V.jsx)(v.a,{children:this.profileAndLogoutItems()})]}):Object(V.jsx)(r.Fragment,{children:this.profileAndLogoutItems()})}},{key:"storeAndInventoryItems",value:function(){return Object(V.jsxs)(r.Fragment,{children:[Object(V.jsx)(v.a.Link,{as:c.b,to:B,style:q.navBarText,children:"Store"}),Object(V.jsx)(v.a.Link,{as:c.b,to:F,style:q.navBarText,children:"My Inventory"})]})}},{key:"profileAndLogoutItems",value:function(){var e="".concat(R.Profile),t={pathname:"".concat(R.LogOut),state:{local:!0}};return Object(V.jsxs)(r.Fragment,{children:[Object(V.jsxs)(v.a.Link,{as:c.b,to:e,style:q.navBarText,children:["Hello ",this.state.userName]}),Object(V.jsx)(v.a.Link,{as:c.b,to:t,style:q.navBarText,children:"Logout"})]})}}]),n}(r.Component);z.displayName=z.name;var q={navBarText:{color:"black",fontWeight:"bold"}},G=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(V.jsx)("footer",{className:"footer border-top text-muted",children:Object(V.jsx)("div",{className:"container",children:"\xa9 2023 - Dotnet Economy"})})}}]),n}(r.Component),H=n.p+"static/media/bg.12058d38.png",W=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(V.jsxs)("div",{style:{backgroundImage:"url(".concat(H,")"),backgroundSize:"cover",height:"100vh"},children:[Object(V.jsx)(z,{}),Object(V.jsx)(p.a,{style:{paddingTop:"50px",paddingBottom:"50px",color:"white",fontSize:"1.3em",fontWeight:"bold"},children:this.props.children}),Object(V.jsx)(G,{})]})}}]),n}(r.Component);W.displayName=W.name;var J=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={isAuthenticated:!1,userName:null,role:null},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this._subscription=E.subscribe((function(){return e.populateState()})),this.populateState()}},{key:"componentWillUnmount",value:function(){E.unsubscribe(this._subscription)}},{key:"populateState",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n,r,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([E.isAuthenticated(),E.getUser()]);case 2:t=e.sent,n=Object(b.a)(t,2),r=n[0],a=n[1],this.setState({isAuthenticated:r,userName:a&&a.name,role:a&&a.role});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("p",{children:"Welcome to the Dotnet Economy website, a cloud native virtual economy system."}),Object(V.jsx)("p",{children:"To get started, you can:"}),Object(V.jsxs)("ul",{children:[Object(V.jsxs)("li",{children:["Visit the ",Object(V.jsx)(c.b,{to:B,children:"Store"})]}),Object(V.jsxs)("li",{children:["Check your ",Object(V.jsx)(c.b,{to:F,children:"Inventory"})]}),this.adminView()]}),this.devOnlyLinks()]})}},{key:"adminView",value:function(){if(this.state.isAuthenticated&&"Admin"===this.state.role)return Object(V.jsxs)(r.Fragment,{children:[Object(V.jsxs)("li",{children:["Manage the ",Object(V.jsx)(c.b,{to:N,children:"Catalog"})]}),Object(V.jsxs)("li",{children:["Manage registered ",Object(V.jsx)(c.b,{to:D,children:"Users"})]})]})}},{key:"devOnlyLinks",value:function(){0}}]),n}(r.Component);J.displayName=J.name;var Y=n(68),Q=n(97),K=n(64),X=n(98),Z=n(95),$=n(101),ee=n(25),te=n(102),ne=n(96),re=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={id:0,name:"",description:"",price:"",alertVisible:!1,validated:!1},e.onChange=function(t){e.setState(Object(ee.a)({},t.target.name,t.target.value))},e.submitNew=function(t){t.preventDefault(),!1===t.currentTarget.checkValidity()?t.stopPropagation():e.createItem(),e.setState({validated:!0})},e.submitEdit=function(t){t.preventDefault(),!1===t.currentTarget.checkValidity()?t.stopPropagation():e.updateItem(),e.setState({validated:!0})},e.showAlert=function(t){e.setState({alertMessage:t,alertColor:"danger",alertVisible:!0})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){if(this.props.item){var e=this.props.item,t=e.id,n=e.name,r=e.description,a=e.price;this.setState({id:t,name:n,description:r,price:a})}}},{key:"createItem",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAccessToken();case 2:t=e.sent,fetch("".concat(window.CATALOG_ITEMS_API_URL),{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({name:this.state.name,description:this.state.description,price:parseFloat(this.state.price)})}).then(function(){var e=Object(j.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=6;break}return e.next=3,t.json();case 3:throw n=e.sent,console.error(n),new Error("Could not add the item: ".concat(n.title));case 6:return e.abrupt("return",t.json());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){n.props.addItemToState(e),n.props.toggle()})).catch((function(e){n.showAlert(e.message)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateItem",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAccessToken();case 2:t=e.sent,fetch("".concat(window.CATALOG_ITEMS_API_URL,"/").concat(this.state.id),{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({id:this.state.id,name:this.state.name,description:this.state.description,price:parseFloat(this.state.price)})}).then(function(){var e=Object(j.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=6;break}return e.next=3,t.json();case 3:throw r=e.sent,console.error(r),new Error("Could not update the item: ".concat(r.title));case 6:n.props.toggle(),n.props.updateItemIntoState(n.state.id);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){n.showAlert(e.message)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(V.jsxs)(te.a,{noValidate:!0,validated:this.state.validated,onSubmit:this.props.item?this.submitEdit:this.submitNew,children:[Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"name",children:"Name:"}),Object(V.jsx)(te.a.Control,{type:"text",name:"name",onChange:this.onChange,value:this.state.name,required:!0}),Object(V.jsx)(te.a.Control.Feedback,{type:"invalid",children:"The Name field is required"})]}),Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"description",children:"Description:"}),Object(V.jsx)(te.a.Control,{type:"text",name:"description",onChange:this.onChange,value:this.state.description})]}),Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"price",children:"Price:"}),Object(V.jsx)(te.a.Control,{type:"number",name:"price",onChange:this.onChange,value:this.state.price,required:!0}),Object(V.jsx)(te.a.Control.Feedback,{type:"invalid",children:"The Price field is required"})]}),Object(V.jsx)(Z.a,{variant:"primary",type:"submit",children:"Save"}),Object(V.jsx)(ne.a,{style:{marginTop:"10px"},variant:this.state.alertColor,show:this.state.alertVisible,children:this.state.alertMessage})]})}}]),n}(a.a.Component),ae=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={modal:!1},e.toggle=function(){e.setState((function(e){return{modal:!e.modal}}))},e}return Object(u.a)(n,[{key:"render",value:function(){var e="Edit Item",t="";return this.props.isNew?(e="Add Item",t=Object(V.jsx)(Z.a,{variant:"primary",onClick:this.toggle,style:{minWidth:"200px"},children:"Add"})):t=Object(V.jsx)(Z.a,{variant:"primary",onClick:this.toggle,children:"Edit"}),Object(V.jsxs)(r.Fragment,{children:[t,Object(V.jsxs)($.a,{show:this.state.modal,className:this.props.className,onHide:this.toggle,children:[Object(V.jsx)($.a.Header,{closeButton:!0,children:e}),Object(V.jsx)($.a.Body,{children:Object(V.jsx)(re,{addItemToState:this.props.addItemToState,updateItemIntoState:this.props.updateItemIntoState,toggle:this.toggle,item:this.props.item})})]})]})}}]),n}(r.Component),se=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={id:"",userId:"",quantity:1,alertVisible:!1,validated:!1},e.onChange=function(t){e.setState(Object(ee.a)({},t.target.name,t.target.value))},e.submitGrant=function(t){t.preventDefault(),!1===t.currentTarget.checkValidity()?t.stopPropagation():e.grantItem(),e.setState({validated:!0})},e.showAlert=function(t){e.setState({alertMessage:t,alertColor:"danger",alertVisible:!0})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){if(this.props.item){var e=this.props.item.id;this.setState({id:e})}}},{key:"grantItem",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAccessToken();case 2:t=e.sent,fetch("".concat(window.INVENTORY_ITEMS_API_URL),{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:this.state.userId,catalogItemId:this.state.id,quantity:parseInt(this.state.quantity)})}).then(function(){var e=Object(j.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=6;break}return e.next=3,t.json();case 3:throw r=e.sent,console.error(r),new Error("Could not grant the item: ".concat(r.title));case 6:n.props.toggle();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){n.showAlert(e.message)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(V.jsxs)(te.a,{noValidate:!0,validated:this.state.validated,onSubmit:this.submitGrant,children:[Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"userId",children:"User Id:"}),Object(V.jsx)(te.a.Control,{type:"text",name:"userId",onChange:this.onChange,value:this.state.userId,required:!0}),Object(V.jsx)(te.a.Control.Feedback,{type:"invalid",children:"The User Id field is required"})]}),Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"quantity",children:"Quantity:"}),Object(V.jsx)(te.a.Control,{type:"number",name:"quantity",onChange:this.onChange,value:this.state.quantity,required:!0}),Object(V.jsx)(te.a.Control.Feedback,{type:"invalid",children:"The Quantity field is required"})]}),Object(V.jsx)(Z.a,{variant:"primary",type:"submit",children:"Grant"}),Object(V.jsx)(ne.a,{style:{marginTop:"10px"},variant:this.state.alertColor,show:this.state.alertVisible,children:this.state.alertMessage})]})}}]),n}(a.a.Component),ie=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={modal:!1},e.toggle=function(){e.setState((function(e){return{modal:!e.modal}}))},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(V.jsxs)(r.Fragment,{children:[Object(V.jsx)(Z.a,{variant:"primary",onClick:this.toggle,children:"Grant"}),Object(V.jsxs)($.a,{show:this.state.modal,className:this.props.className,onHide:this.toggle,children:[Object(V.jsxs)($.a.Header,{closeButton:!0,children:["Grant ",this.props.item.name]}),Object(V.jsx)($.a.Body,{children:Object(V.jsx)(se,{toggle:this.toggle,item:this.props.item})})]})]})}}]),n}(r.Component),ce=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).addItemToState=function(e){r.setState((function(t){return{items:[].concat(Object(Y.a)(t.items),[e])}}))},r.updateState=function(e){r.populateItems()},r.deleteItemFromState=function(e){var t=r.state.items.filter((function(t){return t.id!==e}));r.setState({items:t})},r.state={items:[],loading:!0,loadedSuccess:!1},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.populateItems()}},{key:"populateItems",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAccessToken();case 2:t=e.sent,fetch("".concat(window.CATALOG_ITEMS_API_URL),{headers:t?{Authorization:"Bearer ".concat(t)}:{}}).then((function(e){return e.json()})).then((function(e){return n.setState({items:e,loading:!1,loadedSuccess:!0})})).catch((function(e){console.log(e),n.setState({items:[],loading:!1,loadedSuccess:!1})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteItem",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n,r=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Do you really wish to delete it?")){e.next=6;break}return e.next=4,E.getAccessToken();case 4:n=e.sent,fetch("".concat(window.CATALOG_ITEMS_API_URL,"/").concat(t),{method:"delete",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(e){r.deleteItemFromState(t)})).catch((function(e){console.log(e),window.alert("Could not delete the item.")}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderItemsTable",value:function(e){var t=this;return Object(V.jsxs)(p.a,{style:{paddingTop:"10px",paddingLeft:"0px"},children:[Object(V.jsx)(Q.a,{children:Object(V.jsx)(K.a,{children:Object(V.jsxs)(X.a,{striped:!0,bordered:!0,hover:!0,children:[Object(V.jsx)("thead",{className:"thead-dark",children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"Name"}),Object(V.jsx)("th",{children:"Description"}),Object(V.jsx)("th",{children:"Price"}),Object(V.jsx)("th",{style:{textAlign:"center"},children:"Actions"})]})}),Object(V.jsx)("tbody",{children:!e||e.length<=0?Object(V.jsx)("tr",{children:Object(V.jsx)("td",{colSpan:"6",align:"center",children:Object(V.jsx)("b",{children:"No Items yet"})})}):e.map((function(e){return Object(V.jsxs)("tr",{children:[Object(V.jsx)("td",{children:e.name}),Object(V.jsx)("td",{children:e.description}),Object(V.jsx)("td",{children:e.price}),Object(V.jsx)("td",{align:"center",children:Object(V.jsxs)("div",{children:[Object(V.jsx)(ae,{isNew:!1,item:e,updateItemIntoState:t.updateState}),"\xa0\xa0\xa0",Object(V.jsx)(ie,{item:e}),"\xa0\xa0\xa0",Object(V.jsx)(Z.a,{variant:"danger",onClick:function(){return t.deleteItem(e.id)},children:"Delete"})]})})]},e.id)}))})]})})}),Object(V.jsx)(Q.a,{children:Object(V.jsx)(K.a,{children:Object(V.jsx)(ae,{isNew:!0,addItemToState:this.addItemToState})})})]})}},{key:"render",value:function(){var e=this.state.loading?Object(V.jsx)("p",{children:Object(V.jsx)("em",{children:"Loading..."})}):this.state.loadedSuccess?this.renderItemsTable(this.state.items):Object(V.jsx)("p",{children:"Could not load items"});return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{id:"tabelLabel",children:"Catalog Items"}),e]})}}]),n}(r.Component);ce.displayName=ce.name;var oe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={items:[],loading:!0,loadedSuccess:!1},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.populateItems()}},{key:"populateItems",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n,r,a=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.cameFromUsersPage()){e.next=5;break}t=this.props.location.user.id,e.next=9;break;case 5:return e.next=7,E.getUser();case 7:n=e.sent,t=n.sub;case 9:return e.next=11,E.getAccessToken();case 11:r=e.sent,fetch("".concat(window.INVENTORY_ITEMS_API_URL,"?userId=").concat(t),{headers:r?{Authorization:"Bearer ".concat(r)}:{}}).then((function(e){return e.json()})).then((function(e){return a.setState({items:e,loading:!1,loadedSuccess:!0})})).catch((function(e){console.log(e),a.setState({items:[],loading:!1,loadedSuccess:!1})}));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderItemsTable",value:function(e){var t=this;return Object(V.jsxs)(p.a,{style:{paddingTop:"10px",paddingLeft:"0px"},children:[Object(V.jsx)(Q.a,{children:Object(V.jsx)(K.a,{children:Object(V.jsxs)(X.a,{striped:!0,children:[Object(V.jsx)("thead",{className:"thead-dark",children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"Name"}),Object(V.jsx)("th",{children:"Description"}),Object(V.jsx)("th",{children:"Quantity"})]})}),Object(V.jsx)("tbody",{children:!e||e.length<=0?Object(V.jsx)("tr",{children:Object(V.jsx)("td",{colSpan:"6",align:"center",children:Object(V.jsx)("b",{children:"No Items yet"})})}):e.map((function(e){return Object(V.jsxs)("tr",{children:[Object(V.jsx)("td",{children:e.name}),Object(V.jsx)("td",{children:e.description}),Object(V.jsx)("td",{children:e.quantity})]},e.catalogItemId)}))})]})})}),Object(V.jsx)(Q.a,{children:Object(V.jsx)(K.a,{children:Object(V.jsx)(Z.a,{color:"primary",hidden:!this.cameFromUsersPage(),onClick:function(){return t.props.history.goBack()},children:"Back to Users"})})})]})}},{key:"render",value:function(){var e=this.state.loading?Object(V.jsx)("p",{children:Object(V.jsx)("em",{children:"Loading..."})}):this.state.loadedSuccess?this.renderItemsTable(this.state.items):Object(V.jsx)("p",{children:"Could not load items"});return Object(V.jsxs)("div",{children:[Object(V.jsxs)("h1",{id:"tabelLabel",children:[this.cameFromUsersPage()?this.props.location.user.username:"My"," Inventory"]}),e]})}},{key:"cameFromUsersPage",value:function(){return null!=this.props.location.user}}]),n}(r.Component);oe.displayName=oe.name;var ue=n(99),le=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={id:0,email:"",okubo:"",alertVisible:!1,validated:!1},e.onChange=function(t){e.setState(Object(ee.a)({},t.target.name,t.target.value))},e.submitEdit=function(t){t.preventDefault(),!1===t.currentTarget.checkValidity()?t.stopPropagation():e.updateUser(),e.setState({validated:!0})},e.showAlert=function(t){e.setState({alertMessage:t,alertColor:"danger",alertVisible:!0})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){if(this.props.user){var e=this.props.user,t=e.id,n=e.email,r=e.okubo;this.setState({id:t,email:n,okubo:r})}}},{key:"updateUser",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAccessToken();case 2:t=e.sent,fetch("".concat(window.USERS_API_URL,"/").concat(this.state.id),{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({id:this.state.id,email:this.state.email,okubo:parseFloat(this.state.okubo)})}).then(function(){var e=Object(j.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=6;break}return e.next=3,t.json();case 3:throw r=e.sent,console.error(r),new Error("Could not update the user: ".concat(r.title));case 6:n.props.toggle(),n.props.updateUserIntoState(n.state.id);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){n.showAlert(e.message)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(V.jsxs)(te.a,{noValidate:!0,validated:this.state.validated,onSubmit:this.submitEdit,children:[Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"email",children:"Name:"}),Object(V.jsx)(te.a.Control,{type:"email",name:"email",label:"Email:",onChange:this.onChange,value:this.state.email,required:!0}),Object(V.jsx)(te.a.Control.Feedback,{type:"invalid",children:"The Email field is required"})]}),Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"okubo",children:"Okubo:"}),Object(V.jsx)(te.a.Control,{type:"number",name:"okubo",onChange:this.onChange,value:this.state.okubo,required:!0}),Object(V.jsx)(te.a.Control.Feedback,{type:"invalid",children:"The Okubo field is required"})]}),Object(V.jsx)(Z.a,{variant:"primary",type:"submit",children:"Save"}),Object(V.jsx)(ne.a,{style:{marginTop:"10px"},variant:this.state.alertColor,show:this.state.alertVisible,children:this.state.alertMessage})]})}}]),n}(a.a.Component),he=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={modal:!1},e.toggle=function(){e.setState((function(e){return{modal:!e.modal}}))},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(V.jsxs)(r.Fragment,{children:[Object(V.jsx)(Z.a,{variant:"primary",onClick:this.toggle,children:"Edit"}),Object(V.jsxs)($.a,{show:this.state.modal,className:this.props.className,onHide:this.toggle,children:[Object(V.jsx)($.a.Header,{closeButton:!0,children:"Edit User"}),Object(V.jsx)($.a.Body,{children:Object(V.jsx)(le,{updateUserIntoState:this.props.updateUserIntoState,toggle:this.toggle,user:this.props.user})})]})]})}}]),n}(r.Component),de=n.p+"static/media/inventory-bag.97746de5.png",pe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).updateState=function(e){r.populateUsers()},r.deleteUserFromState=function(e){var t=r.state.users.filter((function(t){return t.id!==e}));r.setState({users:t})},r.state={users:[],loading:!0,loadedSuccess:!1},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.populateUsers()}},{key:"populateUsers",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAccessToken();case 2:t=e.sent,fetch("".concat(window.USERS_API_URL),{headers:t?{Authorization:"Bearer ".concat(t)}:{}}).then((function(e){return e.json()})).then((function(e){return n.setState({users:e,loading:!1,loadedSuccess:!0})})).catch((function(e){console.log(e),n.setState({users:[],loading:!1,loadedSuccess:!1})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteUser",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n,r=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Do you really wish to delete it?")){e.next=6;break}return e.next=4,E.getAccessToken();case 4:n=e.sent,fetch("".concat(window.USERS_API_URL,"/").concat(t),{method:"delete",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(e){r.deleteUserFromState(t)})).catch((function(e){console.log(e),window.alert("Could not delete the user.")}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderUsersTable",value:function(e){var t=this;return Object(V.jsx)(p.a,{style:{paddingTop:"10px",paddingLeft:"0px"},children:Object(V.jsx)(Q.a,{children:Object(V.jsx)(K.a,{children:Object(V.jsxs)(X.a,{striped:!0,children:[Object(V.jsx)("thead",{className:"thead-dark",children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"Id"}),Object(V.jsx)("th",{children:"Email"}),Object(V.jsx)("th",{children:"Okubo"}),Object(V.jsx)("th",{children:"Inventory"}),Object(V.jsx)("th",{style:{textAlign:"center"},children:"Actions"})]})}),Object(V.jsx)("tbody",{children:!e||e.length<=0?Object(V.jsx)("tr",{children:Object(V.jsx)("td",{colSpan:"6",align:"center",children:Object(V.jsx)("b",{children:"No Users yet"})})}):e.map((function(e){return Object(V.jsxs)("tr",{children:[Object(V.jsx)("td",{children:e.id}),Object(V.jsx)("td",{children:e.email}),Object(V.jsx)("td",{children:e.okubo}),Object(V.jsx)("td",{children:Object(V.jsx)(c.b,{to:{pathname:"/inventory",user:e},children:Object(V.jsx)(ue.a,{src:de,height:35})})}),Object(V.jsx)("td",{align:"center",children:Object(V.jsxs)("div",{children:[Object(V.jsx)(he,{user:e,updateUserIntoState:t.updateState}),"\xa0\xa0\xa0",Object(V.jsx)(Z.a,{variant:"danger",onClick:function(){return t.deleteUser(e.id)},children:"Delete"})]})})]},e.id)}))})]})})})})}},{key:"render",value:function(){var e=this.state.loading?Object(V.jsx)("p",{children:Object(V.jsx)("em",{children:"Loading..."})}):this.state.loadedSuccess?this.renderUsersTable(this.state.users):Object(V.jsx)("p",{children:"Could not load users"});return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{id:"tabelLabel",children:"Users"}),e]})}}]),n}(r.Component);pe.displayName=pe.name;var be=n(100),je=n(105),fe=n(59),me=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={id:0,name:"",price:"",quantity:1,alertVisible:!1,alertColor:"",alertMessage:"",isLoading:!1,buttonDisabled:!1,validated:!1},e.connection=(new fe.a).withUrl("".concat(window.TRADING_SERVICE_URL,"/messageHub"),{accessTokenFactory:function(){return E.getAccessToken()}}).withAutomaticReconnect().configureLogging(fe.b.Information).build(),e.onChange=function(t){e.setState(Object(ee.a)({},t.target.name,t.target.value))},e.submitPurchase=function(t){t.preventDefault(),!1===t.currentTarget.checkValidity()?t.stopPropagation():e.purchaseItem(),e.setState({validated:!0})},e.onPurchaseStatusReceived=function(t){console.log("Received purchase status: "+t.currentState),e.setState({isLoading:!1}),"Faulted"===t.currentState?(e.setState({alertMessage:"Could not purchase the item(s). "+t.errorMessage,alertColor:"danger",buttonDisabled:!1}),e.showAlert(!1)):(e.props.updateItemIntoState(e.state.id),e.setState({alertMessage:"Item(s) successfully purchased!",alertColor:"success"}),e.showAlert(!0))},e.showAlert=function(t){e.setState({alertVisible:!0},(function(){t&&window.setTimeout((function(){e.props.toggle()}),2e3)}))},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.item,t=e.id,n=e.name,r=e.price;this.setState({id:t,name:n,price:r}),this.connection.on("ReceivePurchaseStatus",this.onPurchaseStatusReceived),this.connection.start().catch((function(e){console.log("connection error")}))}},{key:"purchaseItem",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("Purchase ".concat(this.state.quantity," ").concat(this.state.name," for ").concat(this.state.price*this.state.quantity," okubo?"))&&(this.setState({buttonDisabled:!0,isLoading:!0,alertVisible:!1}),t=Object(je.a)(),this.fetchRetry(t,3));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchRetry",value:function(){var e=Object(j.a)(m.a.mark((function e(t,n){var r,a=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAccessToken();case 2:return r=e.sent,e.abrupt("return",fetch("".concat(window.PURCHASE_API_URL),{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({itemId:this.state.id,quantity:parseInt(this.state.quantity),idempotencyId:t})}).then(function(){var e=Object(j.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=6;break}return e.next=3,t.json();case 3:throw n=e.sent,console.error(n),new Error("Could not purchase the item: ".concat(n.title));case 6:return console.log("Purchase request completed with status "+t.status),e.abrupt("return",t.json());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var r=n-1;return r?setTimeout((function(){return a.fetchRetry(t,r)}),5e3):(a.setState({alertMessage:e.message,alertColor:"danger",buttonDisabled:!1,isLoading:!1}),void a.showAlert(!1))})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(V.jsxs)(te.a,{noValidate:!0,validated:this.state.validated,onSubmit:this.submitPurchase,children:[Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"price",children:"Price:"}),Object(V.jsx)(te.a.Control,{type:"number",name:"price",value:this.state.price,readOnly:!0})]}),Object(V.jsxs)(te.a.Group,{children:[Object(V.jsx)(te.a.Label,{htmlFor:"quantity",children:"Quantity:"}),Object(V.jsx)(te.a.Control,{type:"number",name:"quantity",onChange:this.onChange,value:this.state.quantity,required:!0}),Object(V.jsx)(te.a.Control.Feedback,{type:"invalid",children:"The Quantity field is required"})]}),Object(V.jsxs)(Z.a,{variant:"primary",type:"submit",disabled:this.state.buttonDisabled,children:[this.state.isLoading?Object(V.jsx)(be.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"",this.state.isLoading?" Purchasing\u2026":"Purchase"]}),Object(V.jsx)(ne.a,{style:{marginTop:"10px"},variant:this.state.alertColor,show:this.state.alertVisible,children:this.state.alertMessage})]})}}]),n}(a.a.Component),ge=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={modal:!1},e.toggle=function(){e.setState((function(e){return{modal:!e.modal}}))},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(V.jsxs)(r.Fragment,{children:[Object(V.jsx)(Z.a,{variant:"primary",onClick:this.toggle,children:"Purchase"}),Object(V.jsxs)($.a,{show:this.state.modal,className:this.props.className,onHide:this.toggle,size:"sm",children:[Object(V.jsxs)($.a.Header,{closeButton:!0,children:["Purchase ",this.props.item.name]}),Object(V.jsx)($.a.Body,{children:Object(V.jsx)(me,{toggle:this.toggle,item:this.props.item,updateItemIntoState:this.props.updateItemIntoState})})]})]})}}]),n}(r.Component),ve=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).updateState=function(e){r.populateItems()},r.state={items:[],userOkubo:0,loading:!0,loadedSuccess:!1},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.populateItems()}},{key:"populateItems",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAccessToken();case 2:t=e.sent,fetch("".concat(window.STORE_API_URL),{headers:t?{Authorization:"Bearer ".concat(t)}:{}}).then((function(e){return e.json()})).then((function(e){return n.setState({items:e.items,userOkubo:e.userOkubo,loading:!1,loadedSuccess:!0})})).catch((function(e){console.log(e),n.setState({items:[],loading:!1,loadedSuccess:!1})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderItemsTable",value:function(e){var t=this;return Object(V.jsxs)(p.a,{style:{paddingTop:"10px",paddingLeft:"0px"},children:[Object(V.jsxs)(Q.a,{className:"align-items-center",children:[Object(V.jsx)(K.a,{align:"right",style:{textAlign:"right",padding:"0px"},children:Object(V.jsx)(te.a.Label,{style:{margin:"0px"},children:"My Okubo:"})}),Object(V.jsx)(K.a,{xs:2,children:Object(V.jsx)(te.a.Control,{type:"number",name:"okubo",id:"okubo",value:this.state.userOkubo,style:{textAlign:"right",padding:"0px"},readOnly:!0})})]}),Object(V.jsx)(Q.a,{style:{paddingTop:"5px"},children:Object(V.jsx)(K.a,{children:Object(V.jsxs)(X.a,{striped:!0,children:[Object(V.jsx)("thead",{className:"thead-dark",children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"Name"}),Object(V.jsx)("th",{children:"Description"}),Object(V.jsx)("th",{children:"Price"}),Object(V.jsx)("th",{children:"Owned"}),Object(V.jsx)("th",{style:{textAlign:"center"},children:"Actions"})]})}),Object(V.jsx)("tbody",{children:!e||e.length<=0?Object(V.jsx)("tr",{children:Object(V.jsx)("td",{colSpan:"6",align:"center",children:Object(V.jsx)("b",{children:"No Items yet"})})}):e.map((function(e){return Object(V.jsxs)("tr",{children:[Object(V.jsx)("td",{children:e.name}),Object(V.jsx)("td",{children:e.description}),Object(V.jsx)("td",{children:e.price}),Object(V.jsx)("td",{children:e.ownedQuantity}),Object(V.jsx)("td",{align:"center",children:Object(V.jsx)(ge,{item:e,updateItemIntoState:t.updateState})})]},e.id)}))})]})})})]})}},{key:"render",value:function(){var e=this.state.loading?Object(V.jsx)("p",{children:Object(V.jsx)("em",{children:"Loading..."})}):this.state.loadedSuccess?this.renderItemsTable(this.state.items):Object(V.jsx)("p",{children:"Could not load items"});return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{id:"tabelLabel",children:"Store Items"}),e]})}}]),n}(r.Component);ve.displayName=ve.name;var Oe=n(53),xe=n(67),ye=["component"],ke=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={ready:!1,authenticated:!1},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this._subscription=E.subscribe((function(){return e.authenticationChanged()})),this.populateAuthenticationState()}},{key:"componentWillUnmount",value:function(){E.unsubscribe(this._subscription)}},{key:"render",value:function(){var e=this.state,t=e.ready,n=e.authenticated,r=document.createElement("a");r.href=this.props.path;var a="".concat(r.protocol,"//").concat(r.host).concat(r.pathname).concat(r.search).concat(r.hash),s="".concat(R.Login,"?").concat(x,"=").concat(encodeURI(a));if(t){var i=this.props,c=i.component,o=Object(xe.a)(i,ye);return Object(V.jsx)(d.b,Object(Oe.a)(Object(Oe.a)({},o),{},{render:function(e){return n?Object(V.jsx)(c,Object(Oe.a)({},e)):Object(V.jsx)(d.a,{to:s})}}))}return Object(V.jsx)("div",{})}},{key:"populateAuthenticationState",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.isAuthenticated();case 2:t=e.sent,this.setState({ready:!0,authenticated:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"authenticationChanged",value:function(){var e=Object(j.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({ready:!1,authenticated:!1}),e.next=3,this.populateAuthenticationState();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(r.Component),we=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={message:void 0},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.action;switch(e){case I:this.login(this.getReturnUrl());break;case A:this.processLoginCallback();break;case C:var t=new URLSearchParams(window.location.search).get(y);this.setState({message:t});break;case T:this.redirectToProfile();break;case L:this.redirectToRegister();break;default:throw new Error("Invalid action '".concat(e,"'"))}}},{key:"render",value:function(){var e=this.props.action,t=this.state.message;if(t)return Object(V.jsx)("div",{children:t});switch(e){case I:return Object(V.jsx)("div",{children:"Processing login"});case A:return Object(V.jsx)("div",{children:"Processing login callback"});case T:case L:return Object(V.jsx)("div",{});default:throw new Error("Invalid action '".concat(e,"'"))}}},{key:"login",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={returnUrl:t},e.next=3,E.signIn(n);case 3:r=e.sent,e.t0=r.status,e.next=e.t0===M.Redirect?7:e.t0===M.Success?8:e.t0===M.Fail?11:13;break;case 7:case 10:return e.abrupt("break",14);case 8:return e.next=10,this.navigateToReturnUrl(t);case 11:return this.setState({message:r.message}),e.abrupt("break",14);case 13:throw new Error("Invalid status result ".concat(r.status,"."));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processLoginCallback",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location.href,e.next=3,E.completeSignIn(t);case 3:n=e.sent,e.t0=n.status,e.next=e.t0===M.Redirect?7:e.t0===M.Success?8:e.t0===M.Fail?11:13;break;case 7:throw new Error("Should not redirect.");case 8:return e.next=10,this.navigateToReturnUrl(this.getReturnUrl(n.state));case 10:return e.abrupt("break",14);case 11:return this.setState({message:n.message}),e.abrupt("break",14);case 13:throw new Error("Invalid authentication result status '".concat(n.status,"'."));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getReturnUrl",value:function(e){var t=new URLSearchParams(window.location.search).get(x);if(t&&!t.startsWith("".concat(window.location.origin,"/")))throw new Error("Invalid return url. The return url needs to have the same origin as the current page.");return e&&e.returnUrl||t||"".concat(window.location.origin,"/")}},{key:"redirectToRegister",value:function(){this.redirectToApiAuthorizationPath(window.IDENTITY_SERVICE_URL,"".concat(R.IdentityRegisterPath,"?").concat(x,"=").concat(encodeURI(R.Login)))}},{key:"redirectToProfile",value:function(){this.redirectToApiAuthorizationPath(window.IDENTITY_SERVICE_URL,R.IdentityManagePath)}},{key:"redirectToApiAuthorizationPath",value:function(e,t){var n="".concat(e).concat(t);window.location.replace(n)}},{key:"navigateToReturnUrl",value:function(e){window.location.replace(e)}}]),n}(r.Component),Se=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={message:void 0,isReady:!1,authenticated:!1},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.action;switch(e){case w:window.history.state.state.local?this.logout(this.getReturnUrl()):this.setState({isReady:!0,message:"The logout was not initiated from within the page."});break;case k:this.processLogoutCallback();break;case S:this.setState({isReady:!0,message:"You successfully logged out!"});break;default:throw new Error("Invalid action '".concat(e,"'"))}this.populateAuthenticationState()}},{key:"render",value:function(){var e=this.state,t=e.isReady,n=e.message;if(!t)return Object(V.jsx)("div",{});if(n)return Object(V.jsx)("div",{children:n});var r=this.props.action;switch(r){case w:return Object(V.jsx)("div",{children:"Processing logout"});case k:return Object(V.jsx)("div",{children:"Processing logout callback"});case S:return Object(V.jsx)("div",{children:n});default:throw new Error("Invalid action '".concat(r,"'"))}}},{key:"logout",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={returnUrl:t},e.next=3,E.isAuthenticated();case 3:if(!e.sent){e.next=20;break}return e.next=7,E.signOut(n);case 7:r=e.sent,e.t0=r.status,e.next=e.t0===M.Redirect?11:e.t0===M.Success?12:e.t0===M.Fail?15:17;break;case 11:return e.abrupt("break",18);case 12:return e.next=14,this.navigateToReturnUrl(t);case 14:return e.abrupt("break",18);case 15:return this.setState({message:r.message}),e.abrupt("break",18);case 17:throw new Error("Invalid authentication result status.");case 18:e.next=21;break;case 20:this.setState({message:"You successfully logged out!"});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processLogoutCallback",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location.href,e.next=3,E.completeSignOut(t);case 3:n=e.sent,e.t0=n.status,e.next=e.t0===M.Redirect?7:e.t0===M.Success?8:e.t0===M.Fail?11:13;break;case 7:throw new Error("Should not redirect.");case 8:return e.next=10,this.navigateToReturnUrl(this.getReturnUrl(n.state));case 10:return e.abrupt("break",14);case 11:return this.setState({message:n.message}),e.abrupt("break",14);case 13:throw new Error("Invalid authentication result status.");case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"populateAuthenticationState",value:function(){var e=Object(j.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.isAuthenticated();case 2:t=e.sent,this.setState({isReady:!0,authenticated:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getReturnUrl",value:function(e){var t=new URLSearchParams(window.location.search).get(x);if(t&&!t.startsWith("".concat(window.location.origin,"/")))throw new Error("Invalid return url. The return url needs to have the same origin as the current page.");return e&&e.returnUrl||t||"".concat(window.location.origin).concat(R.LoggedOut)}},{key:"navigateToReturnUrl",value:function(e){return window.location.replace(e)}}]),n}(r.Component),Ie=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(V.jsxs)(r.Fragment,{children:[Object(V.jsx)(d.b,{path:R.Login,render:function(){return Ae(I)}}),Object(V.jsx)(d.b,{path:R.LoginFailed,render:function(){return Ae(C)}}),Object(V.jsx)(d.b,{path:R.LoginCallback,render:function(){return Ae(A)}}),Object(V.jsx)(d.b,{path:R.Profile,render:function(){return Ae(T)}}),Object(V.jsx)(d.b,{path:R.Register,render:function(){return Ae(L)}}),Object(V.jsx)(d.b,{path:R.LogOut,render:function(){return Ce(w)}}),Object(V.jsx)(d.b,{path:R.LogOutCallback,render:function(){return Ce(k)}}),Object(V.jsx)(d.b,{path:R.LoggedOut,render:function(){return Ce(S)}})]})}}]),n}(r.Component);function Ae(e){return Object(V.jsx)(we,{action:e})}function Ce(e){return Object(V.jsx)(Se,{action:e})}n(90);var Te=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(V.jsxs)(W,{children:[Object(V.jsx)(d.b,{exact:!0,path:"/",component:J}),Object(V.jsx)(ke,{path:N,component:ce}),Object(V.jsx)(ke,{path:F,component:oe}),Object(V.jsx)(ke,{path:D,component:pe}),Object(V.jsx)(ke,{path:B,component:ve}),Object(V.jsx)(d.b,{path:R.ApiAuthorizationPrefix,component:Ie})]})}}]),n}(r.Component);Te.displayName=Te.name;var Le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,106)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),s(e),i(e)}))},Ue=document.getElementsByTagName("base")[0].getAttribute("href");i.a.render(Object(V.jsx)(c.a,{basename:Ue,children:Object(V.jsx)(Te,{})}),document.getElementById("root")),Le()}},[[91,1,2]]]);
//# sourceMappingURL=main.c0110425.chunk.js.map